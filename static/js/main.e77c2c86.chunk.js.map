{"version":3,"sources":["Result.jsx","NumPad.jsx","MathOperationsPad.jsx","Calculator.jsx","App.js","index.js"],"names":["ResultBox","styled","div","backgroundColor","height","fontSize","display","padding","justifyContent","outline","border","boxShadow","Result","content","Layout","flexDirection","gap","Row","Button","button","width","alignItems","NumPad","whenAction","onClick","MathOperationsPad","onAction","CaclulatorLayout","className","result","numPad","operationsPad","flexFlow","Caclulator","props","onNumber","num","numAction$","next","onMathOperation","operation","mathOperation$","state","expr","this","propName","onUnmount$","Subject","propsChanges$","inputMode$","pipe","filter","prev","current","map","shareReplay","bufferSize","refCount","mathExpression$","streamMathExpression","result$","streamResult","merge","tap","setState","takeUntil","subscribe","complete","prevProps","action","value","op","scan","length","reduce","values","operator","a","b","Error","JSON","stringify","React","Component","App","calcMode","mode","rootElement","document","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.e77c2c86.chunk.js","sourcesContent":["import React from \"react\";\nimport styled from \"@emotion/styled\";\n\nconst ResultBox = styled.div({\n  backgroundColor: \"lightgray\",\n  //color: \"white\",\n  height: \"60px\",\n  fontSize: \"40px\",\n  display: \"flex\",\n  padding: \"5px\",\n  justifyContent: \"center\",\n  outline: \"none\",\n  border: \"none\",\n  boxShadow: \"none\"\n});\n\nexport default function Result({ content }) {\n  return <ResultBox>{content}</ResultBox>;\n}\n","import React from \"react\";\nimport styled from \"@emotion/styled\";\n\nconst Layout = styled.div({\n  display: \"flex\",\n  flexDirection: \"column-reverse\",\n  gap: \"5px\"\n});\n\nconst Row = styled.div({\n  display: \"flex\",\n  gap: \"5px\"\n});\n\nconst Button = styled.button({\n  width: \"120px\",\n  height: \"100px\",\n  display: \"flex\",\n  justifyContent: \"center\",\n  alignItems: \"center\",\n  fontSize: \"30px\"\n});\n\nexport default function NumPad({ whenAction }) {\n  return (\n    <Layout>\n      <Row>\n        <Button onClick={() => whenAction(0)}>0</Button>\n      </Row>\n      <Row>\n        <Button onClick={() => whenAction(1)}>1</Button>\n        <Button onClick={() => whenAction(2)}>2</Button>\n        <Button onClick={() => whenAction(3)}>3</Button>\n      </Row>\n      <Row>\n        <Button onClick={() => whenAction(4)}>4</Button>\n        <Button onClick={() => whenAction(5)}>5</Button>\n        <Button onClick={() => whenAction(6)}>6</Button>\n      </Row>\n      <Row>\n        <Button onClick={() => whenAction(7)}>7</Button>\n        <Button onClick={() => whenAction(8)}>8</Button>\n        <Button onClick={() => whenAction(9)}>9</Button>\n      </Row>\n    </Layout>\n  );\n}\n","import React from \"react\";\nimport styled from \"@emotion/styled\";\n\nconst Layout = styled.div({\n  display: \"flex\",\n  gap: \"5px\"\n});\n\nconst Button = styled.button({\n  width: \"120px\",\n  height: \"100px\",\n  display: \"flex\",\n  justifyContent: \"center\",\n  alignItems: \"center\",\n  fontSize: \"30px\"\n});\n\nexport default function MathOperationsPad({ onAction }) {\n  return (\n    <Layout>\n      <Button onClick={() => onAction(\"+\")}>+</Button>\n      <Button onClick={() => onAction(\"-\")}>-</Button>\n    </Layout>\n  );\n}\n","import React from \"react\";\nimport { pipe, Subject, merge } from \"rxjs\";\nimport { filter, map, scan, shareReplay, takeUntil, tap } from \"rxjs/operators\";\nimport styled from \"@emotion/styled\";\nimport Result from \"./Result\";\nimport NumPad from \"./NumPad\";\nimport MathOperationsPad from \"./MathOperationsPad\";\nimport \"./styles.css\";\n\nconst CaclulatorLayout = styled(\n  ({ className, result, numPad, operationsPad }) => (\n    <div className={className}>\n      <div className=\"result\">{result}</div>\n      <div className=\"keysPads\">\n        {numPad} {operationsPad}\n      </div>\n    </div>\n  )\n)({\n  display: \"flex\",\n  flexFlow: \"column\",\n  gap: \"15px\",\n  alignItems: \"stretch\",\n  \".result\": {},\n  \".keysPads\": {\n    display: \"flex\",\n    gap: \"15px\"\n  }\n});\n\nexport default class Caclulator extends React.Component {\n  render() {\n    return (\n      <CaclulatorLayout\n        result={<Result content={this.state.result} />}\n        numPad={<NumPad whenAction={this.onNumber} />}\n        operationsPad={<MathOperationsPad onAction={this.onMathOperation} />}\n      />\n    );\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.onNumber = (num) => this.numAction$.next(num);\n    this.onMathOperation = (operation) => this.mathOperation$.next(operation);\n\n    this.state = {\n      result: \"\",\n      expr: []\n    };\n  }\n\n  componentDidMount() {\n    this.onUnmount$ = new Subject();\n    this.propsChanges$ = new Subject();\n    this.numAction$ = new Subject();\n    this.mathOperation$ = new Subject();\n    this.inputMode$ = handlePropChange(\"mode\", this.propsChanges$);\n    this.mathExpression$ = this.streamMathExpression();\n    this.result$ = this.streamResult();\n\n    merge(\n      this.inputMode$,\n      this.result$.pipe(\n        tap((result) => this.setState((state) => ({ ...state, result })))\n      ),\n      this.mathExpression$.pipe(\n        tap((expr) => this.setState((state) => ({ ...state, expr })))\n      )\n    )\n      .pipe(takeUntil(this.onUnmount$))\n      .subscribe();\n  }\n\n  componentWillUnmount() {\n    this.onUnmount$.next();\n    this.onUnmount$.complete();\n  }\n\n  componentDidUpdate(prevProps) {\n    this.propsChanges$.next({ prev: prevProps, current: this.props });\n  }\n\n  streamMathExpression() {\n    return pipe(\n      () =>\n        merge(\n          this.numAction$.pipe(\n            map((num) => ({ action: \"number\", value: num }))\n          ),\n          this.mathOperation$.pipe(\n            map((op) => ({ action: \"operation\", value: op }))\n          )\n        ),\n      scan((expr, { action, value }) => {\n        if (\n          action === \"number\" &&\n          expr.length > 0 &&\n          expr[expr.length - 1].action === \"number\"\n        ) {\n          return expr;\n        }\n\n        if (\n          action === \"operation\" &&\n          (expr.length === 0 || expr[expr.length - 1].action === \"operation\")\n        ) {\n          return expr;\n        }\n\n        return [...expr, { action, value }];\n      }, [])\n    )(null);\n  }\n\n  streamResult() {\n    return pipe(\n      () => this.mathExpression$,\n      filter((expr) => expr.length >= 3 && expr.length % 2 === 1),\n      map((expr) =>\n        expr.reduce(\n          ({ values, operator }, { action, value }) => {\n            if (action === \"operation\") {\n              return { values, operator: value };\n            }\n\n            if (operator === null) {\n              return { values: [...values, value], operator };\n            }\n\n            function op(action) {\n              if (action === \"+\") return (a, b) => a + b;\n              if (action === \"-\") return (a, b) => a - b;\n              throw new Error(\"unimplemented\");\n            }\n\n            const result = op(operator)(values[0], value);\n\n            return { values: [result], operator: null };\n          },\n          { values: [], operator: null }\n        )\n      ),\n      map(({ values }) => values[0]),\n      map((result) => JSON.stringify(result))\n    )(null);\n  }\n}\n\nfunction handlePropChange(propName, propsChanges$) {\n  return propsChanges$.pipe(\n    filter(({ prev, current }) => prev[propName] !== current[propName]),\n    map(({ current }) => current[propName]),\n    shareReplay({ bufferSize: 1, refCount: true })\n  );\n}\n","import React from \"react\";\nimport Calculator from \"./Calculator\";\nimport \"./styles.css\";\n\nexport default class App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      calcMode: \"scientific\"\n    };\n  }\n  render() {\n    return <Calculator mode={this.state.calcMode} />;\n  }\n}\n","import { StrictMode } from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n  rootElement\n);\n"],"sourceRoot":""}